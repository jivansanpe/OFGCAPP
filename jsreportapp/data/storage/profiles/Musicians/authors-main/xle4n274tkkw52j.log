{"type":"operationStart","subtype":"profile","data":{"_id":"ZfAvPgs9bE4SQxoR","timestamp":"2023-02-21T22:37:38.638Z","state":"queued","mode":"standard","creationDate":"2023-02-21T22:37:38.640Z","modificationDate":"2023-02-21T22:37:38.640Z","shortid":"slkctu-","$entitySet":"profiles"},"doDiffs":false,"timestamp":1677019058639,"id":"ptr6htom4jchnqz","previousOperationId":null,"operationId":"q2so5fljwmgxldz"}
{"type":"log","level":"info","message":"Render request 7 queued for execution and waiting for available worker","previousOperationId":"q2so5fljwmgxldz","timestamp":1677019058639,"id":"popnv7jowlhsth1"}
{"type":"operationStart","subtype":"render","name":"authors-main","previousOperationId":"q2so5fljwmgxldz","timestamp":1677019058653,"id":"9n60y3spq05ojrc","previousEventId":"ptr6htom4jchnqz","operationId":"kgzpkywezwbkvyo"}
{"type":"log","timestamp":1677019058653,"level":"info","message":"Starting rendering request 7","meta":{"rootId":"xle4n274tkkw52j","id":"xle4n274tkkw52j"},"id":"div5ge1gjx9baf3","previousOperationId":"kgzpkywezwbkvyo"}
{"type":"log","timestamp":1677019058653,"level":"info","message":"Rendering template { name: authors-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"xle4n274tkkw52j","id":"xle4n274tkkw52j"},"id":"7sombklh3uiephu","previousOperationId":"kgzpkywezwbkvyo"}
{"type":"log","timestamp":1677019058654,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"xle4n274tkkw52j","id":"xle4n274tkkw52j"},"id":"7l1cfic73kxg2mq","previousOperationId":"kgzpkywezwbkvyo"}
{"type":"log","timestamp":1677019058658,"level":"debug","message":"Executing script authors-script (beforeRender)","meta":{"rootId":"xle4n274tkkw52j","id":"xle4n274tkkw52j"},"id":"55q2jrqy264m7i9","previousOperationId":"kgzpkywezwbkvyo"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1677019058700,"id":"nodwq5nddfhqiku","previousEventId":"9n60y3spq05ojrc","operationId":"sgg2zyov6auspoz","previousOperationId":"kgzpkywezwbkvyo"}
{"type":"operationStart","subtype":"script","name":"scripts authors-script","previousOperationId":"sgg2zyov6auspoz","timestamp":1677019058700,"id":"zsbl159aem43sp1","previousEventId":"nodwq5nddfhqiku","operationId":"5y9yrkn169lf5dk"}
{"type":"log","timestamp":1677019058940,"level":"warn","message":"Error when processing render request 7\n(because) error when evaluating custom script /Musicians/authors-script\nauthor is not defined\n\n(sandbox.js line 21:20)\n\n  19 |             }\n  20 |         })\n> 21 |         names.push(author.name);\n     |                    ^\n  22 |         counts.push(author.count);\n  23 |         special_count.push(count);\n  24 |         });\n\n(sandbox.js line 13:29)\n\n  11 |      counts = [];\n  12 |      special_count = [];\n> 13 |      resMusicians.data.data.forEach(musician => {\n     |                             ^\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n  16 |         musician['events'].forEach(event =>{\n\n\nReferenceError: author is not defined\n    at sandbox.js:21:20\n    at Array.forEach (<anonymous>)\n    at Object.beforeRender (sandbox.js:13:29)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async executionFn (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:184:24)\n    at async WorkerReporter._runInSandbox (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:180:14)\n    at async executeScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)","meta":{"rootId":"xle4n274tkkw52j","id":"xle4n274tkkw52j"},"id":"ewyf6o2c7qfisqx","previousOperationId":"5y9yrkn169lf5dk"}
{"type":"log","timestamp":1677019058940,"level":"warn","message":"Rendering request 7 finished with error in 302 ms","meta":{"rootId":"xle4n274tkkw52j","id":"xle4n274tkkw52j"},"id":"gp81c5fcd4o4vev","previousOperationId":"5y9yrkn169lf5dk"}
{"type":"error","timestamp":1677019058945,"statusCode":400,"weak":true,"lineNumber":21,"decoratedSuffix":"\n\n(sandbox.js line 21:20)\n\n  19 |             }\n  20 |         })\n> 21 |         names.push(author.name);\n     |                    ^\n  22 |         counts.push(author.count);\n  23 |         special_count.push(count);\n  24 |         });\n\n(sandbox.js line 13:29)\n\n  11 |      counts = [];\n  12 |      special_count = [];\n> 13 |      resMusicians.data.data.forEach(musician => {\n     |                             ^\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n  16 |         musician['events'].forEach(event =>{\n\n","entity":{"shortid":"LzD1Qor","name":"authors-script","content":"// server side script fetching remote data and preparing report data source\r\nconst axios = require('axios');\r\n\r\n\r\n// add jsreport hook which modifies the report input data\r\nasync function beforeRender(req, res) {\r\n    const resMusicians = await axios.get('http://localhost:8000/api/musicians')\r\n    req.data.musicians = [];\r\n     req.data.musicians.push(resMusicians.data.data);\r\n     names = [];\r\n     counts = [];\r\n     special_count = [];\r\n     resMusicians.data.data.forEach(musician => {\r\n        count = 0;\r\n        musician['count']= musician['events'].length;\r\n        musician['events'].forEach(event =>{\r\n            if(event['pivot'].special == \"Si\"){\r\n                count += 1;\r\n            }\r\n        })\r\n        names.push(author.name);\r\n        counts.push(author.count);\r\n        special_count.push(count);\r\n        });\r\n    req.data.musicians.push(names);\r\n    req.data.musicians.push(counts);\r\n    req.data.musicians.push(special_count);\r\n    console.log(counts);\r\n    return req.data.musicians;\r\n}"},"property":"content","logged":true,"previousOperationId":"5y9yrkn169lf5dk","id":"8zzigbfsv9gf2ya","stack":"ReferenceError: author is not defined\n    at sandbox.js:21:20\n    at Array.forEach (<anonymous>)\n    at Object.beforeRender (sandbox.js:13:29)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async executionFn (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:184:24)\n    at async WorkerReporter._runInSandbox (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:180:14)\n    at async executeScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)","message":"Error when evaluating custom script /Musicians/authors-script\nauthor is not defined\n\n(sandbox.js line 21:20)\n\n  19 |             }\n  20 |         })\n> 21 |         names.push(author.name);\n     |                    ^\n  22 |         counts.push(author.count);\n  23 |         special_count.push(count);\n  24 |         });\n\n(sandbox.js line 13:29)\n\n  11 |      counts = [];\n  12 |      special_count = [];\n> 13 |      resMusicians.data.data.forEach(musician => {\n     |                             ^\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n  16 |         musician['events'].forEach(event =>{\n\n"}
