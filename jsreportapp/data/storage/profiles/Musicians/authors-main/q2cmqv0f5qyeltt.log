{"type":"operationStart","subtype":"profile","data":{"_id":"hszlafNFNI9d6OSH","timestamp":"2023-02-21T22:37:02.621Z","state":"queued","mode":"standard","creationDate":"2023-02-21T22:37:02.623Z","modificationDate":"2023-02-21T22:37:02.623Z","shortid":"COUo6J5","$entitySet":"profiles"},"doDiffs":false,"timestamp":1677019022622,"id":"7p38azwpq9i5178","previousOperationId":null,"operationId":"xuk8csyok118swj"}
{"type":"log","level":"info","message":"Render request 6 queued for execution and waiting for available worker","previousOperationId":"xuk8csyok118swj","timestamp":1677019022622,"id":"ks8lkbjky82b8wr"}
{"type":"operationStart","subtype":"render","name":"authors-main","previousOperationId":"xuk8csyok118swj","timestamp":1677019022631,"id":"bt0dcq3spfahkk8","previousEventId":"7p38azwpq9i5178","operationId":"q2mqihhi8my4mlb"}
{"type":"log","timestamp":1677019022631,"level":"info","message":"Starting rendering request 6","meta":{"rootId":"q2cmqv0f5qyeltt","id":"q2cmqv0f5qyeltt"},"id":"92sfjwt16ux0c6r","previousOperationId":"q2mqihhi8my4mlb"}
{"type":"log","timestamp":1677019022631,"level":"info","message":"Rendering template { name: authors-main, recipe: chrome-pdf, engine: handlebars, preview: true }","meta":{"rootId":"q2cmqv0f5qyeltt","id":"q2cmqv0f5qyeltt"},"id":"vv8chegurckutvx","previousOperationId":"q2mqihhi8my4mlb"}
{"type":"log","timestamp":1677019022632,"level":"debug","message":"Data item not defined for this template.","meta":{"rootId":"q2cmqv0f5qyeltt","id":"q2cmqv0f5qyeltt"},"id":"a2ggylszbd9hdaz","previousOperationId":"q2mqihhi8my4mlb"}
{"type":"log","timestamp":1677019022634,"level":"debug","message":"Executing script authors-script (beforeRender)","meta":{"rootId":"q2cmqv0f5qyeltt","id":"q2cmqv0f5qyeltt"},"id":"6ooosvfxmcu9xy0","previousOperationId":"q2mqihhi8my4mlb"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1677019022673,"id":"z7rznegbn8lm968","previousEventId":"bt0dcq3spfahkk8","operationId":"kfz28sr70g0y5v1","previousOperationId":"q2mqihhi8my4mlb"}
{"type":"operationStart","subtype":"script","name":"scripts authors-script","previousOperationId":"kfz28sr70g0y5v1","timestamp":1677019022673,"id":"57b0oe5oylsel8c","previousEventId":"z7rznegbn8lm968","operationId":"pnp2jfk46w83pks"}
{"type":"log","timestamp":1677019022939,"level":"warn","message":"Error when processing render request 6\n(because) error when evaluating custom script /Musicians/authors-script\nmusician.forEach is not a function\n\n(sandbox.js line 16:18)\n\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n> 16 |         musician.forEach(event =>{\n     |                  ^\n  17 |             if(event['pivot'].special == \"Si\"){\n  18 |                 count += 1;\n  19 |             }\n\n(sandbox.js line 13:29)\n\n  11 |      counts = [];\n  12 |      special_count = [];\n> 13 |      resMusicians.data.data.forEach(musician => {\n     |                             ^\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n  16 |         musician.forEach(event =>{\n\n\nTypeError: musician.forEach is not a function\n    at sandbox.js:16:18\n    at Array.forEach (<anonymous>)\n    at Object.beforeRender (sandbox.js:13:29)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async executionFn (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:184:24)\n    at async WorkerReporter._runInSandbox (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:180:14)\n    at async executeScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)","meta":{"rootId":"q2cmqv0f5qyeltt","id":"q2cmqv0f5qyeltt"},"id":"dtsn0yg95dhrqbn","previousOperationId":"pnp2jfk46w83pks"}
{"type":"log","timestamp":1677019022939,"level":"warn","message":"Rendering request 6 finished with error in 318 ms","meta":{"rootId":"q2cmqv0f5qyeltt","id":"q2cmqv0f5qyeltt"},"id":"axcgc032qzkm93p","previousOperationId":"pnp2jfk46w83pks"}
{"type":"error","timestamp":1677019022943,"statusCode":400,"weak":true,"lineNumber":16,"decoratedSuffix":"\n\n(sandbox.js line 16:18)\n\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n> 16 |         musician.forEach(event =>{\n     |                  ^\n  17 |             if(event['pivot'].special == \"Si\"){\n  18 |                 count += 1;\n  19 |             }\n\n(sandbox.js line 13:29)\n\n  11 |      counts = [];\n  12 |      special_count = [];\n> 13 |      resMusicians.data.data.forEach(musician => {\n     |                             ^\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n  16 |         musician.forEach(event =>{\n\n","entity":{"shortid":"LzD1Qor","name":"authors-script","content":"// server side script fetching remote data and preparing report data source\r\nconst axios = require('axios');\r\n\r\n\r\n// add jsreport hook which modifies the report input data\r\nasync function beforeRender(req, res) {\r\n    const resMusicians = await axios.get('http://localhost:8000/api/musicians')\r\n    req.data.musicians = [];\r\n     req.data.musicians.push(resMusicians.data.data);\r\n     names = [];\r\n     counts = [];\r\n     special_count = [];\r\n     resMusicians.data.data.forEach(musician => {\r\n        count = 0;\r\n        musician['count']= musician['events'].length;\r\n        musician.forEach(event =>{\r\n            if(event['pivot'].special == \"Si\"){\r\n                count += 1;\r\n            }\r\n        })\r\n        names.push(author.name);\r\n        counts.push(author.count);\r\n        special_count.push(count);\r\n        });\r\n    req.data.musicians.push(names);\r\n    req.data.musicians.push(counts);\r\n    req.data.musicians.push(special_count);\r\n    console.log(counts);\r\n    return req.data.musicians;\r\n}"},"property":"content","logged":true,"previousOperationId":"pnp2jfk46w83pks","id":"uobqbto3aeoub3c","stack":"TypeError: musician.forEach is not a function\n    at sandbox.js:16:18\n    at Array.forEach (<anonymous>)\n    at Object.beforeRender (sandbox.js:13:29)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async executionFn (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:11)\n    at async run (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:184:24)\n    at async WorkerReporter._runInSandbox (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:180:14)\n    at async executeScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)\n    at async Scripts.handleBeforeRender (D:\\Clase\\Segundo\\Proyecto\\OFGCAPP\\jsreportapp\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:64:7)","message":"Error when evaluating custom script /Musicians/authors-script\nmusician.forEach is not a function\n\n(sandbox.js line 16:18)\n\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n> 16 |         musician.forEach(event =>{\n     |                  ^\n  17 |             if(event['pivot'].special == \"Si\"){\n  18 |                 count += 1;\n  19 |             }\n\n(sandbox.js line 13:29)\n\n  11 |      counts = [];\n  12 |      special_count = [];\n> 13 |      resMusicians.data.data.forEach(musician => {\n     |                             ^\n  14 |         count = 0;\n  15 |         musician['count']= musician['events'].length;\n  16 |         musician.forEach(event =>{\n\n"}
